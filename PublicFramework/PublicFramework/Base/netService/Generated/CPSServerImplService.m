/*
	CPSServerImplService.m
	The implementation classes and methods for the ServerImplService web service.
	Generated by SudzC.com
*/

#import "CPSServerImplService.h"
				
#import "Soap.h"
	
#import "CPSinvoke.h"
#import "CPSinvokeResponse.h"
#import "WebConfig.h"
/* Implementation of the service */
				
@implementation CPSServerImplService

	- (id) init
	{
		if(self = [super init])
		{
            NSString *url=[NSString stringWithFormat:@"%@%@%@",url_portal,server_url,url_webservice_path];
 
            self.serviceUrl =url;// @"http://121.8.157.221:9090/services/ChinaPostService";新底座
           // self.serviceUrl = @"http://121.8.157.221:9090/services/ChinaPostService?wsdl";旧底座
            //测试网关

            self.mynamespace = NAMESPACE;//@"http://service.chinapost.com/";
			self.headers = nil;
			self.logging = YES;
		}
		return self;
	}
	
	- (id) initWithUsername: (NSString*) username andPassword: (NSString*) password {
		if(self = [super initWithUsername:username andPassword:password]) {
		}
        self.requestTimeout=60; //webService默认超时时间
		return self;
	}
	
	+ (CPSServerImplService*) service {
		return [CPSServerImplService serviceWithUsername:nil andPassword:nil];
	}
	
	+ (CPSServerImplService*) serviceWithUsername: (NSString*) username andPassword: (NSString*) password {
		return [[[CPSServerImplService alloc] initWithUsername:username andPassword:password] autorelease];
	}

		
	/* Returns NSString*.  */
	- (SoapRequest*) invoke: (id <SoapDelegate>) handler arg0: (NSString*) arg0
	{
		return [self invoke: handler action: nil arg0: arg0];
	}

	- (SoapRequest*) invoke: (id) _target action: (SEL) _action arg0: (NSString*) arg0
		{
		NSMutableArray* _params = [NSMutableArray array];
		
		[_params addObject: [[[SoapParameter alloc] initWithValue: arg0 forName: @"arg0"] autorelease]];
            
            //old @"ser:invoke"   new @"invoke"
		NSString* _envelope = [Soap createEnvelope: @"ser:invoke" forNamespace: self.mynamespace withParameters: _params withHeaders: self.headers];
		SoapRequest* _request = [SoapRequest create: _target action: _action service: self soapAction: @"" postData: _envelope deserializeTo: nil];
        _request.requestTimeout=_requestTimeout;
		[_request send];
		return _request;
	}



@end
	